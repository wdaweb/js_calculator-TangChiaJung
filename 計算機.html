<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>20220419-計算機</title>
    <link href="https://fonts.googleapis.com/css2?family=Oxanium&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
        integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        html,
        body {
            width: 100%;
            height: 100%;
            background: url(https://images.unsplash.com/photo-1478098711619-5ab0b478d6e6?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=2070&q=80) no-repeat fixed top/cover;
        }


        table {
            margin: 10%;
            width: 500px;
            height: 500px;
            font-family: 'Oxanium', cursive;
            font-size: 36px;

            background: rgba(0, 0, 0, 0.5);
            border-radius: 5%;
            /* box-shadow: 5px 5px 10px rgba(0,0,0,0.5); */
            /* filter: drop-shadow(5px 5px 6px rgba(255, 255, 255, 0.8)); */
            border-collapse: separate;
            border-spacing: 20px;
        }

        td {

            width: 60px;
            height: 60px;
            /* border: 1px solid rgb(156, 156, 156); */
            text-align: center;
            vertical-align: middle;
            color: white;
            border-radius: 10%;
            background: rgba(255, 255, 255, 0.3);

            box-shadow: 1px 1px 5px rgba(255, 255, 255, 0.8);
            filter: drop-shadow(5px 5px 6px rgba(86, 86, 86, 0.8));


        }


        #input {
            text-align: right;
            padding: 20px;
            background: rgba(255, 255, 255, 0.3);
            /* border-radius: 0%; */



        }

        td:hover {
            background: rgb(255, 255, 255);
            color: black;
            border-radius: 10%;

        }

        #input:hover {
            color: white;
            border-radius: 10%;
        }

        span,
        i {
            color: white;
        }

        #loading{
            width: 100%;
            height: 100%;
            position: fixed;
            background: gray;
            color: white;
            text-align: center;
            display: table;
            transition:  opacity .5s;
        }

        #loading-content{
            display: table-cell;
            vertical-align: middle;
        }

        img{
            width: 300px;
        }

    </style>
</head>

<body>

    <div id="loading">
        <div id="loading-content">
            <img src="eee.svg" alt="">
            <h1>載入中</h1>
        </div>
    </div>


    <div>
        <input id="vol" type="range" max="10" min="0" value="10">
        <i id="span" class="fa-solid fa-volume-high"></i>

        <table>

            <tr>
                <td colspan="4" id="input">0</td>

            </tr>

            <tr>
                <td id="tdc">C</td>
                <td id="tda">/</td>
                <td id="tdb">*</td>
                <td id="tde"><i class="fa-solid fa-delete-left"></i></td>
            </tr>
            <tr>
                <td id="td7">7</td>
                <td id="td8">8</td>
                <td id="td9">9</td>
                <td id="tdf">-</td>
            </tr>
            <tr>
                <td id="td4">4</td>
                <td id="td5">5</td>
                <td id="td6">6</td>
                <td id="tdg">+</td>
            </tr>
            <tr>
                <td id="td1">1</td>
                <td id="td2">2</td>
                <td id="td3">3</td>
                <td id="tdh" rowspan="2">=</td>
            </tr>
            <tr>
                <td colspan="2" id="td0">0</td>
                <td id="tdi">.</td>

            </tr>
        </table>


    </div>

    <script>

        const loading = document.getElementById('loading')
        window.onload = () => {
            console.log('window onload')
            loading.style.opacity = 0
            setTimeout(() => {
                loading.style.display = 'none'
            }, 500);
        }
        document.onreadystatechange = () => {
            console.log(document.readyState)
        }


        const span = document.getElementById('span')
        const input = document.getElementById('input')
        const tds = document.querySelectorAll('td:not(#input)')
        const vol = document.getElementById('vol')
        const v = new Audio();//+上老師的喵喵叫
        v.src = "https://rogeraabbccdd.github.io/F2E-book/assets/ch12/meow.mp3";
        v.volume = vol.value * 0.1



        vol.oninput = () => {//根據音量更改icon

            span.classList.remove('fa-volume-high') //移除class
            span.classList.remove('fa-volume-xmark')//更改的時候再刪除原本的class
            span.classList.remove('fa-volume-low')

            if (vol.value <= 10 && vol.value > 5) {
                span.classList.add('fa-volume-high')//add class
                // span.innerHTML = `<i class="fa-solid fa-volume-high"></i>`
            } else if (vol.value == 0) {
                span.classList.add(`fa-volume-xmark`)
                // span.innerHTML = `<i class="fa-solid fa-volume-xmark"></i>`
            } else {
                span.classList.add(`fa-volume-low`)
                // span.innerHTML = `<i class="fa-solid fa-volume"></i>`
            }


        }





        for (const td of tds) {

            td.onclick = () => {
                const text = td.innerText
                calc(text)
                v.volume = vol.value * 0.1
                v.play()//+上老師的喵喵叫
            }//onclick over


            document.onkeydown = event => {
                calc(event.key)
                v.volume = vol.value * 0.1
                v.play()//+上老師的喵喵叫
            }//onkeydown over


            // v.src = "https://rogeraabbccdd.github.io/F2E-book/assets/ch12/meow.mp3";
            // v.play()

            //calc()開始
            const calc = (value) => {


                //字串過長時，縮小字體
                if (input.innerText.length > 11) {
                    input.style.fontSize = "20px"
                } else if (input.innerText.length < 10) {
                    input.style.fontSize = "36px"
                }

                if (value === 'Enter' || value === '=') {
                    //執行算式
                    input.innerText = eval(input.innerText)

                } else if (
                    !isNaN(parseInt(value)) ||
                    value === '+' ||
                    value === '-' ||
                    value === '*' ||
                    value === '/' ||
                    value === '.'
                ) {
                    if (input.innerText.length < 22) { //限制字串長度避免寬度變形

                        if (input.innerText === '0') {
                            input.innerText = value
                        } else {
                            if (!isNaN(input.innerText[input.innerText.length - 1]) || !isNaN(parseInt(value))) {
                                input.innerText += value
                                //判斷最後一個字為數字 or key為數字時，才可以增加value。
                                //修正+-*/重複疊加造成式子失敗現象
                            }
                        }
                    }
                } else if (value === 'Backspace' || value === '') {
                    //Backspace 設為返回
                    input.innerText = input.innerText.substring(0, input.innerText.length - 1)//.substring(保留範圍)
                    if (input.innerText.length === 0) {
                        input.innerText = '0'
                    }
                } else if (value === 'c' || value === 'C') { //大小寫c -> reset
                    input.innerText = '0'

                }

                // 效果(數字部分
                if (!isNaN(parseInt(value))) {
                    document.getElementById('td' + value).style.background = "white"
                    setTimeout(() => {
                        document.getElementById('td' + value).style.background = "rgba(255, 255, 255, 0.3)"

                    }, 50)
                }

                // 效果(字符部分)
                if (value === '/') {
                    document.getElementById('tda').style.background = "white"
                    setTimeout(() => { document.getElementById('tda').style.background = "rgba(255, 255, 255, 0.3)" }, 50)
                } else if (value === '*') {
                    document.getElementById('tdb').style.background = "white"
                    setTimeout(() => { document.getElementById('tdb').style.background = "rgba(255, 255, 255, 0.3)" }, 50)
                } else if (value === 'Backspace') {
                    document.getElementById('tde').style.background = "white"
                    setTimeout(() => { document.getElementById('tde').style.background = "rgba(255, 255, 255, 0.3)" }, 50)
                } else if (value === '-') {
                    document.getElementById('tdf').style.background = "white"
                    setTimeout(() => { document.getElementById('tdf').style.background = "rgba(255, 255, 255, 0.3)" }, 50)
                } else if (value === '+') {
                    document.getElementById('tdg').style.background = "white"
                    setTimeout(() => { document.getElementById('tdg').style.background = "rgba(255, 255, 255, 0.3)" }, 50)
                } else if (value === '=' || value === 'Enter') {
                    document.getElementById('tdh').style.background = "white"
                    setTimeout(() => { document.getElementById('tdh').style.background = "rgba(255, 255, 255, 0.3)" }, 50)
                } else if (value === '.') {
                    document.getElementById('tdi').style.background = "white"
                    setTimeout(() => { document.getElementById('tdi').style.background = "rgba(255, 255, 255, 0.3)" }, 50)
                } else if (value === 'c' || value === 'C') {
                    document.getElementById('tdc').style.background = "white"
                    setTimeout(() => { document.getElementById('tdc').style.background = "rgba(255, 255, 255, 0.3)" }, 50)
                }
                console.log(value)
            }//calc()結束

        }

    </script>

</body>

</html>